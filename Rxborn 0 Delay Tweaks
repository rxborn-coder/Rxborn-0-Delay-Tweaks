@echo off
::  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
::  â•‘  ðŸ”¥  Rxborn 0 Delay Tweaks  â€“  clean pick-menu               â•‘
::  â•‘  Save as .bat â†’ Right-click â†’ Run as ADMIN                    â•‘
::  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
title Rxborn 0 Delay Tweaks
setlocal EnableExtensions EnableDelayedExpansion
color 0B
mode con: cols=75 lines=40

:: 0. Safety net
echo Creating restore pointâ€¦
wmic.exe /Namespace:\\root\default Path SystemRestore Call CreateRestorePoint "Rxborn-0Delay-Pre", 100, 7 >nul 2>&1

:MENU
cls
echo.
echo    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
echo    â”‚  âš¡  Rxborn 0 Delay Tweaks  â€“  choose any combination       â”‚
echo    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
echo.
echo    1)  ðŸŽ¹  Keyboard  â€“  1 ms repeat, USB suspend OFF
echo    2)  ðŸ–±ï¸  Mouse      â€“  raw input, accel OFF, USB suspend OFF
echo    3)  ðŸŽ®  Controller  â€“  4 ms polling, HID idle OFF
echo    4)  âš™ï¸  System      â€“  Ultimate Performance, HPET OFF, MSI mode
echo    5)  ðŸŽ¯  Game/GPU    â€“  Ultra-Low-Latency, FSO OFF
echo    6)  ðŸš€  QUICK-ALL   â€“  apply 1-5 in one shot
echo    7)  âŒ  EXIT
echo.
choice /C 1234567 /N /M "Type number(s) and press ENTER: "
set "CH=%ERRORLEVEL%"
if "%CH%"=="7" exit /b

::----- 6. Quick-All (runs all blocks with pause & cls) -----
if "%CH%"=="6" (
   call :KEYBOARD & cls
   call :MOUSE   & cls
   call :CONTROLLER & cls
   call :SYSTEM  & cls
   call :GAME    & cls
   echo.
   echo ðŸš€  Quick-ALL finished!
   echo    Restart your PC to finalise MSI & HPET changes.
   pause
   goto :MENU
)

::----- 1. Keyboard -----
if "%CH%"=="1" call :KEYBOARD && pause && goto :MENU
goto :MENU

::----- 2. Mouse -----
if "%CH%"=="2" call :MOUSE   && pause && goto :MENU
goto :MENU

::----- 3. Controller -----
if "%CH%"=="3" call :CONTROLLER && pause && goto :MENU
goto :MENU

::----- 4. System -----
if "%CH%"=="4" call :SYSTEM  && pause && goto :MENU
goto :MENU

::----- 5. Game/GPU -----
if "%CH%"=="5" call :GAME    && pause && goto :MENU
goto :MENU

::::::::::::::::::::::  SUB-ROUTINES  ::::::::::::::::::::::
:KEYBOARD
echo.
echo ðŸŽ¹  Keyboard tweaksâ€¦
reg add "HKCU\Control Panel\Keyboard" /v KeyboardDelay /t REG_SZ /d 0 /f >nul
reg add "HKCU\Control Panel\Keyboard" /v KeyboardSpeed /t REG_SZ /d 31 /f >nul
powercfg -SETACVALUEINDEX SCHEME_CURRENT 2a737441-1930-4402-8d77-b2bebba308a3 48e6b7a6-50f5-4782-a5d4-53bb8f07e226 0 >nul
powercfg -SETDCVALUEINDEX SCHEME_CURRENT 2a737441-1930-4402-8d77-b2bebba308a3 48e6b7a6-50f5-4782-a5d4-53bb8f07e226 0 >nul
echo    âœ” Done.
goto :eof

:MOUSE
echo.
echo ðŸ–±ï¸  Mouse tweaksâ€¦
reg add "HKCU\Control Panel\Mouse" /v MouseSpeed /t REG_SZ /d 0 /f >nul
reg add "HKCU\Control Panel\Mouse" /v MouseThreshold1 /t REG_SZ /d 0 /f >nul
reg add "HKCU\Control Panel\Mouse" /v MouseThreshold2 /t REG_SZ /d 0 /f >nul
powercfg -SETACVALUEINDEX SCHEME_CURRENT 2a737441-1930-4402-8d77-b2bebba308a3 48e6b7a6-50f5-4782-a5d4-53bb8f07e226 0 >nul
powercfg -SETDCVALUEINDEX SCHEME_CURRENT 2a737441-1930-4402-8d77-b2bebba308a3 48e6b7a6-50f5-4782-a5d4-53bb8f07e226 0 >nul
echo    âœ” Done.
goto :eof

:CONTROLLER
echo.
echo ðŸŽ®  Controller tweaksâ€¦
reg add "HKLM\SYSTEM\CurrentControlSet\Services\HidUsb\Parameters" /v IdleEnable /t REG_DWORD /d 0 /f >nul
echo    âœ” Done.
goto :eof

:SYSTEM
echo.
echo âš™ï¸  System tweaksâ€¦
powercfg -duplicatescheme e9a42b02-d5df-448d-aa00-03f14749eb61 >nul 2>&1
powercfg -SETACTIVE e9a42b02-d5df-448d-aa00-03f14749eb61
bcdedit /set useplatformclock false >nul 2>&1
powershell -NoP -C "Get-WmiObject Win32_PNPEntity | Where {$_.Name -match 'NVIDIA|AMD|Intel|Gigabit|Realtek|Wireless'} | %% { $id = $_.PNPDeviceID; $reg = \"HKLM:\SYSTEM\CurrentControlSet\Enum\$id\Device Parameters\Interrupt Management\MessageSignaledInterruptProperties\"; if (Test-Path $reg) { Set-ItemProperty -Path $reg -Name MSISupported -Value 1 -Force } }" 2>nul
echo    âœ” Done.  (Restart later for MSI & HPET.)
goto :eof

:GAME
echo.
echo ðŸŽ¯  Game / GPU tweaksâ€¦
reg add "HKLM\SOFTWARE\NVIDIA Corporation\Global\NVTweak" /v LowLatencyMode /t REG_DWORD /d 1 /f >nul 2>&1
reg add "HKLM\SOFTWARE\AMD\CN" /v LatencyMode /t REG_DWORD /d 1 /f >nul 2>&1
reg add "HKCU\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers" /v "*Disabled" /t REG_DWORD /d 1 /f >nul 2>&1
echo    âœ” Done.
goto :eof
